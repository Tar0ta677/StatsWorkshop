install.packages("lme4")
set.seed(100)
data1 <- rnorm(100,100,10)
set.seed(100)
data1 <- rnorm(100,100,10)
mean(data1)
meanarr <- seq(90, 110, by = 0.1)
resarr <- rep(NA, length(meanarr))
for (i in i:length(meanarr)){
resarr[i] <- sum((data1 - meanarr[i])^2)
}
meanarr <- seq(90, 110, by = 0.1)
resarr <- rep(NA, length(meanarr))
for (i in 1:length(meanarr)){
resarr[i] <- sum((data1 - meanarr[i])^2)
}
meanarr[which.min(resarr)]
plot(meanarr, resarr)
set.seed(101)
data2 <- rbinom(100, size = 20, prob = 0.5)
summary(data2)
res2 <- dbinom(data2, size = 20, prob = 0.5)
head(res2)
res2 <- dbinom(data2, size = 20, prob = 0.5)
head(res2)
prod(res2)
log(prod(res2))
res2 <- dbinom(data2, size = 20, prob = 0.5)
head(res2)
prod(res2)
log(prod(res2))
sum(log(res2))
probarr <- seq(0.01, 0.99, by = 0.01)
res2arr <- rep(NA, length(probarr))
for(i in 1:length(probarr)){
res2arr[i] <- log(prod(dbinom(data2, size = 20, prob = probarr[i])))
}
probarr[which.max(res2arr)]
probarr <- seq(0.01, 0.99, by = 0.01)
res2arr <- rep(NA, length(probarr))
for(i in 1:length(probarr)){
res2arr[i] <- log(prod(dbinom(data2, size = 20, prob = probarr[i])))
}
probarr[which.max(res2arr)]
plot(probarr, res2arr)
library("lme4", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library(lme4)
data3 <- sleepstudy
summary(sleepstudy)
res.lmer <- lmer(Reaction ~ Days + (1 + Days | Subject))
res.lmer <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3)
summary(res.lmer)
summary(res.lmer)
res.lmer2 <- lmer(Reaction ~ Days + (1 | Subject), data = data3)
anova(res.lmer, res.lmer2)
res.lmerML <- lmer(Reaction ~ Days + (1 + Days | Subjects), data = data3, REML = FALSE)
res.lmerML <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3, REML = FALSE)
res.lmerML <- lmer(Reaction ~ 1 + (1 | Subject), data = data3, REML = FALSE)
anova(res.lmerML, res.lmerML)
res.lmerML <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3, REML = FALSE)
res.lmerML2 <- lmer(Reaction ~ 1 + (1 | Subject), data = data3, REML = FALSE)
anova(res.lmerML, res.lmerML)
res.lmerML <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3, REML = FALSE)
res.lmerML2 <- lmer(Reaction ~ 1 + (1 | Subject), data = data3, REML = FALSE)
anova(res.lmerML, res.lmerML2)
install.packages("lmerTest")
res.lmer3 <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3)
res.lmer3 <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3)
library(lmerTest)
res.lmer3 <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3)
library(lmerTest)
res.lmer3 <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3)
library(lmerTest)
res.lmer3 <- lmer(Reaction ~ Days + (1 + Days | Subject), data = data3)
summary(res.lmer3)
setwd("~/Desktop/midoribon/StatsWorkshop/Chapter03/scripts")
setwd("~/Desktop/StatsWorkshop/Chapter03/scripts")
d <- read.csv("data3a.csv")
hist(d$x)
plot(d$x, d$y, pch = c(1, 16)[d$f])
fit.all <- glm(y ~ x + f, data = d, family = poisson)
fit.all
logLik(fit.all)
fit.all.id <- glm(y ~ x + f, data = d, family = poisson(link = identity))
fit.all.id
x.range <- seq(5, 25, by = 0.1)
x.range
ft <- factor("T", levels = levels(d$f))
fc <- factor("C", levels = levels(d$f))
p.log.t <- predict(fit.all, data.frame(x = x.range, f = ft ), type="response")
x.range <- seq(5, 25, by = 0.1)
x.range
ft <- factor("T", levels = levels(d$f))
fc <- factor("C", levels = levels(d$f))
p.log.t <- predict(fit.all, data.frame(x = x.range, f = ft ), type="response")
p.log.t
p.log.c <- predict(fit.all, data.frame(x = x.range, f = fc ), type="response")
p.id.t <- predict(fit.all.id, data.frame(x = x.range, f = ft ), type="response")
p.id.c <- predict(fit.all.id, data.frame(x = x.range, f = fc ), type="response")
plot(d$x, d$y, xlim = c(5, 20), ylim = c(5, 20), pch = c(1, 16)[d$f])
lines(x.range, p.log.t, col = "red")
lines(x.range, p.log.c, col = "blue")
lines(x.range, p.id.t, col = "green")
lines(x.range, p.id.c, col = "purple")
